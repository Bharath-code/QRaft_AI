# Technical Architecture (Next.js Edition)

## 1. Stack
* **Framework:** Next.js 15 (App Router)
* **Language:** TypeScript
* **Styling:** Tailwind CSS + Shadcn/UI
* **Database:** Supabase (PostgreSQL)
* **Auth:** Supabase Auth (SSR Helpers)
* **AI Inference:** Replicate API
* **Email:** Resend API
* **Payments:** Razorpay (India) / Lemon Squeezy (Global)

## 2. Database Schema (Supabase SQL)

```sql
-- Users and Credits
create table profiles (
  id uuid references auth.users on delete cascade,
  email text,
  credits int default 0,
  is_pro boolean default false
);

-- The Links (Redirects)
create table dynamic_links (
  id uuid default gen_random_uuid() primary key,
  user_id uuid references auth.users(id),
  short_code text unique not null,
  destination_url text not null,
  active boolean default true,
  created_at timestamp with time zone default now()
);

-- Analytics & Radar
create table scan_events (
  id bigint generated by default as identity primary key,
  link_id uuid references dynamic_links(id),
  city text,
  country text,
  device_type text,
  user_agent text,
  is_bot boolean default false,
  scanned_at timestamp with time zone default now()
);

-- Anonymous Messages (Tea Box)
create table messages (
  id uuid default gen_random_uuid() primary key,
  recipient_id uuid references auth.users(id),
  content text not null,
  sender_meta jsonb,
  created_at timestamp default now()
);
